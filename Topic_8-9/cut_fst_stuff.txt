Fst between the groups (or species in this case) using the perl tool vcf2fst.pl. This is a custom script from Greg Owens, since we want to keep the numerator and denominator from the Fst calculations, which is hard to do. (Lots of other programs calculate Fst - can you think of a reason why might it be important to keep track of both the denominator and numerator?)

We need two files, a sample info file and a group file. The sample info file tells the program which population each sample is in and the group file tells the program which populations to compare. We can make them here:

```
for i in `cat samplelist.txt`;
        do echo -e "$i\t${i/%????/}";
done > sampleinfo.txt
echo -e "ANN\t1\nARG\t2" > popinfo.txt
```

This script was originally made to work with unphased data. That means that genotype calls are depicted by "0/1" or "1/1" values, rather than "0\|1" or "1\|1" (remember that newer snp calling methods use haplotype-based methods and thus can infer phase over small tracts). Because we checked and made sure that "\|" are only used in this vcf for phased genotype calls (you should quickly check with grep!), as a work around, we can replace all "\|" instances with "\". We can pipe the output of this modified file to calculate Fst for each site.

```
zcat vcf/full_genome.filtered.vcf.gz | sed 's/|/\//g' | perl /mnt/bin/vcf2fst.pl sampleinfo.txt popinfo.txt \
> analysis/full_genome.filtered.fst.txt

```
We're going to move from the command line to desktop Rstudio, but as a last step lets copy our samplelist file to the analysis directory so we can use it later.
```bash
cp samplelist.txt analysis/
```

Forward to plotting on the [next page](./plotting_structure.md).
